# This references a standard debian container from the
# Docker Hub https://registry.hub.docker.com/_/debian/
# Read more about containers on our dev center
# http://devcenter.wercker.com/docs/containers/index.html
# Steps make up the actions in your pipeline
# Read more about steps on our dev center:
# http://devcenter.wercker.com/docs/steps/index.html
box: webgpu/pandoc
build:
  steps:
    - script:
      name: build documents
      code: |
        mkdir build
        cd build 
        cmake -DBUILD_LIBWB_LIBRARY=OFF \
              -DBUILD_SOLUTION=OFF \
              -DBUILD_DESCRIPTION=ON \
              -DBUILD_DATASET_GENERATOR=OFF \
              -DBUILD_TEMPLATE=OFF .. 
        make
        ls -l
    - s3sync:
      key-id: $AWS_ACCESS_KEY_ID
      key-secret: $AWS_SECRET_ACCESS_KEY
      bucket-url: $AWS_BUCKET_URL
      source-dir: build
      opts: --acl-private
  after-steps:
    - wantedly/pretty-slack-notify:
        webhook_url: $SLACK_WEBHOOK_URL

